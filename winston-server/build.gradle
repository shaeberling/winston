apply plugin: 'java'
apply plugin: 'gradle-one-jar'

version = '0.0.1'


dependencies {
  compile project(':winston-protos')
  compile project(':winston-libs')
  compile 'org.simpleframework:simple-http:6+'
  compile 'com.google.guava:guava:+'
  compile 'com.google.code.findbugs:jsr305:3+'
  testCompile 'junit:junit:4.12'
  testCompile 'org.mockito:mockito-core:1.10.19'
}

jacocoTestReport {
  dependsOn test
  sourceDirectories = project.files(sourceSets.main.allSource.srcDirs)
  classDirectories =  project.files(sourceSets.main.output)
  reports {
    xml.enabled true
  }
}

task nodeDaemon (type: OneJar) {
  mainClass = 'com.s13g.winston.node.NodeDaemon'
  archiveName = 'winston-node-daemon.jar'
  manifest {
    attributes 'Implementation-Title': 'Winston Node Daemon',
               'Implementation-Version': version,
               'Timestamp': String.valueOf(System.currentTimeMillis())
  }
  useStable = false
}

task masterDaemon (type: OneJar) {
  mainClass = 'com.s13g.winston.master.MasterDaemon'
  archiveName 'winston-master-daemon.jar'
  manifest {
    attributes 'Implementation-Title': 'Winston Master Daemon',
               'Implementation-Version': version,
               'Timestamp': String.valueOf(System.currentTimeMillis())
  }
  useStable = false
}

task sauronDaemon (type: OneJar) {
  mainClass = 'com.s13g.winston.tools.sauron.SauronDaemon'
  archiveName 'winston-sauron-daemon.jar'
  manifest {
    attributes 'Implementation-Title': 'Winston Sauron Daemon',
               'Implementation-Version': version,
               'Timestamp': String.valueOf(System.currentTimeMillis())
  }
  useStable = false
}

